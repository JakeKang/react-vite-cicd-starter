# 커밋 내역 저장 방법 비교

GitLab 커밋 내역을 저장하는 3가지 방법을 비교합니다.

---

## 🎯 방법 1: URL만 저장 (가장 간단 ⭐ 추천)

### 장점
- ✅ 구현이 매우 간단 (텍스트 파일 생성만)
- ✅ 파일 크기 작음 (몇 KB)
- ✅ CI/CD 실행 시간 빠름
- ✅ 인증 문제 없음

### 단점
- ❌ 나중에 수동으로 HTML 저장 필요
- ❌ GitLab 프로젝트가 삭제되면 접근 불가

### 구현 방법

**.gitlab-ci.yml**:
```yaml
archive_build:
  stage: archive
  script:
    - mkdir -p build-artifacts
    - |
      cat > build-artifacts/commit-${CI_PIPELINE_ID}.txt << EOF
      GitLab 커밋 페이지:
      ${CI_PROJECT_URL}/-/commit/${CI_COMMIT_SHA}
      
      수동 저장 방법:
      1. 위 URL을 브라우저에서 열기
      2. 우클릭 > "다른 이름으로 저장"
      3. HTML 파일로 저장
      EOF
  artifacts:
    paths:
      - build-artifacts/
```

### 사용 방법
1. GitLab에서 artifacts 다운로드
2. `commit-123.txt` 파일 열기
3. 적힌 URL을 브라우저에서 열기
4. 우클릭 > "다른 이름으로 저장" > HTML로 저장

---

## 🎯 방법 2: wget/curl로 자동 다운로드

### 장점
- ✅ 완전 자동화
- ✅ GitLab의 깔끔한 스타일 그대로 저장
- ✅ 추가 작업 없음

### 단점
- ❌ GITLAB_TOKEN 필요 (Private 프로젝트)
- ❌ 인증 설정 복잡
- ❌ GitLab 버전에 따라 HTML 구조 변경 가능

### 구현 방법

**.gitlab-ci.yml**:
```yaml
archive_build:
  stage: archive
  before_script:
    - apk add --no-cache curl
  script:
    - mkdir -p commit-htmls
    - |
      curl -H "PRIVATE-TOKEN: $GITLAB_TOKEN" \
           -o "commit-htmls/commit-${CI_COMMIT_SHA}.html" \
           "${CI_PROJECT_URL}/-/commit/${CI_COMMIT_SHA}"
  artifacts:
    paths:
      - commit-htmls/
```

### GitLab Token 생성
1. GitLab > User Settings > Access Tokens
2. Token name: `commit-archiver`
3. Scopes: `read_api`, `read_repository`
4. Create token
5. GitLab CI/CD Variables에 `GITLAB_TOKEN` 등록

---

## 🎯 방법 3: 커스텀 HTML 생성 (원래 방법)

### 장점
- ✅ 완전한 커스터마이징 가능
- ✅ 특정 정보만 표시 가능
- ✅ 회사 브랜딩 적용 가능

### 단점
- ❌ 구현 복잡
- ❌ HTML/CSS 작성 필요
- ❌ 유지보수 어려움
- ❌ GitLab 스타일만큼 깔끔하지 않을 수 있음

### 구현 방법

원래 제공했던 `.gitlab-ci.yml`의 `archive_build` 스테이지 참조

---

## 📊 비교표

| 항목 | URL만 저장 | wget 자동 | 커스텀 HTML |
|------|-----------|----------|------------|
| 구현 난이도 | ⭐ 쉬움 | ⭐⭐ 보통 | ⭐⭐⭐ 어려움 |
| 자동화 | ❌ 수동 저장 필요 | ✅ 완전 자동 | ✅ 완전 자동 |
| 인증 필요 | ❌ 불필요 | ✅ GITLAB_TOKEN | ❌ 불필요 |
| 스타일 | GitLab 원본 | GitLab 원본 | 커스텀 |
| 파일 크기 | 1KB | ~500KB | ~10KB |
| 유지보수 | ✅ 쉬움 | ✅ 쉬움 | ❌ 어려움 |

---

## 🎯 권장 사항

### 소규모 팀 / 간단한 프로젝트
→ **방법 1: URL만 저장** ⭐

이유:
- 가장 간단하고 빠름
- 필요할 때만 수동으로 HTML 저장
- GitLab이 살아있는 한 접근 가능

### 중대형 팀 / 장기 보관 필요
→ **방법 2: wget 자동 다운로드** ⭐⭐

이유:
- 완전 자동화
- GitLab 프로젝트 삭제 시에도 HTML 보관
- 규정 준수 (감사, 컴플라이언스)

### 특수 요구사항 (브랜딩, 커스텀)
→ **방법 3: 커스텀 HTML**

이유:
- 회사 로고, 색상 등 브랜딩 필요
- 특정 정보만 표시 (민감 정보 제외)
- 외부 공유용 리포트 생성

---

## 💡 실제 사용 예시

### 방법 1 사용 시나리오

```bash
# 1. GitLab Artifacts에서 다운로드
# build-artifacts/commit-123.txt

# 2. 파일 내용:
GitLab 커밋 페이지:
https://gitlab.com/yourgroup/project/-/commit/abc123

# 3. 브라우저에서 URL 열기
# 4. Ctrl+S 또는 우클릭 > 다른 이름으로 저장
# 5. commit-abc123.html로 저장 완료
```

### 방법 2 사용 시나리오

```bash
# 1. GitLab CI/CD 자동 실행
# 2. Artifacts에 commit-htmls/commit-abc123.html 생성됨
# 3. 다운로드하여 바로 사용
# 4. 끝!
```

---

## 🔧 하이브리드 방식 (추천 ⭐⭐⭐)

두 가지 방법을 모두 제공하여 유연성 확보:

```yaml
# 기본: URL만 저장 (항상 실행)
archive_build:
  stage: archive
  script:
    - # URL 텍스트 파일 생성
  artifacts:
    paths:
      - build-artifacts/

# 선택: HTML 자동 다운로드 (수동 실행)
download_commit_html:
  stage: archive
  script:
    - # wget으로 HTML 다운로드
  artifacts:
    paths:
      - commit-htmls/
  when: manual  # 필요할 때만 수동 실행
```

**장점:**
- 평소에는 가볍게 URL만 저장
- 중요한 커밋은 수동으로 HTML 다운로드
- 최고의 유연성

---

## 📝 결론

**대부분의 경우 → 방법 1 (URL만 저장)** 추천!

이유:
- GitLab의 커밋 페이지가 이미 완벽함
- 필요할 때 브라우저에서 2클릭으로 저장
- CI/CD가 단순하고 빠름
- 인증 문제 없음

**장기 보관이 중요한 경우 → 하이브리드 방식** 추천!

이유:
- 평소엔 가볍게, 필요 시 완전 자동화
- 최고의 유연성
- 점진적으로 확장 가능
